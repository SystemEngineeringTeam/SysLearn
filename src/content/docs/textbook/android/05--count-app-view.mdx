---
title: カウントアプリの見た目を作ろう
description: Jetpack Composeをうまく活用して、見た目を作っていきましょう。
slug: textbook/android/count-app-view
sidebar:
    order: 5
---

import { Aside } from "@astrojs/starlight/components";
import { Image } from "astro:assets";

import import_gif from "./_images/05/import.gif";
import run_app from "./_images/05/run_app.gif";
import slide039 from "./_images/05/slide-039.png";
import slide040 from "./_images/05/slide-040.png";
import slide041 from "./_images/05/slide-041.png";
import slide042 from "./_images/05/slide-042.png";
import slide043 from "./_images/05/slide-043.png";
import slide044 from "./_images/05/slide-044.png";
import slide045 from "./_images/05/slide-045.png";
import slide046 from "./_images/05/slide-046.png";
import slide047 from "./_images/05/slide-047.png";
import slide048 from "./_images/05/slide-048.png";
import slide049 from "./_images/05/slide-049.png";
import slide050 from "./_images/05/slide-050.png";
import slide051 from "./_images/05/slide-051.png";
import slide052 from "./_images/05/slide-052.png";
import slide053 from "./_images/05/slide-053.png";
import slide054 from "./_images/05/slide-054.png";
import slide055 from "./_images/05/slide-055.png";
import slide056 from "./_images/05/slide-056.png";
import slide057 from "./_images/05/slide-057.png";
import slide058 from "./_images/05/slide-058.png";
import slide059 from "./_images/05/slide-059.png";

## 勉強会で使用するサンプルアプリのリポジトリ

今回のサンプルコードは以下のリポジトリから確認できます。もし追いつけなかったときに確認してみてください。

**GitHub リポジトリ**: https://github.com/harutiro/CountAppSysHack

<Aside>
リポジトリにはカウントアプリの完成版コードが含まれています。学習中に困ったときの参考にしてください。
</Aside>

## カウントアプリの機能

これから作成するカウントアプリでは、以下の機能を実装します。

- カウントを表示するテキスト
- カウントを増やすボタン

シンプルな構成ですが、Androidアプリ開発の基本的な要素を学ぶことができます。

## 現状の状態確認

<Image src={slide040} alt="現状の状態確認" />

先ほど、プロジェクトが作成できて、以下のような画面が表示されているか確認をしてください。できていない場合はプロジェクトの新規作成をしてください。

Android Studioで `MainActivity.kt` を開くと、以下のようなコードが表示されています。

```kotlin
package io.github.harutiro.countapp

import ...

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContent {
            CountAppTheme {
                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding ->
                    Greeting(
                        name = "Android",
                        modifier = Modifier.padding(innerPadding)
                    )
                }
            }
        }
    }
}
```

## コードのいらないところを消そう

デフォルトで書かれたコードがあるので、使わないため、ここまで綺麗にしておきましょう。

```kotlin
package io.github.harutiro.countapp

import ...

class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContent {
            CountAppTheme {
                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding ->

                }
            }
        }
    }
}
```

<Aside>
`innerPadding`のエラーは無視で大丈夫です。使われてないので、画面が崩れる可能性があるよと教えてくれているだけです。
</Aside>

## Composable関数を用いてカウントアプリを表示する部分を作ろう

<Image src={slide042} alt="CountAppScreen関数の追加" />

`MainActivity`クラスの中の`Scaffold`内に`CountAppScreen`を追加し、クラスの外に`CountAppScreen`関数を定義します。

```kotlin
class MainActivity : ComponentActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContent {
            CountAppTheme {
                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding ->
                    CountAppScreen(
                        modifier = Modifier
                            .fillMaxSize()
                            .padding(innerPadding)
                    )
                }
            }
        }
    }
}

@Composable
fun CountAppScreen(modifier: Modifier = Modifier) {

}
```

<Aside type="note" title="@Composable関数とは？">

`@Composable`関数について説明します。

```kotlin
@Composable
fun QuizScreen() {
    Scaffold(
        topBar = { SelfIntroductionAppBar() }
    ) { paddingValues ->
        Column(
            Modifier
                .padding(paddingValues)
                .padding(16.dp)
        ) {
            SkillQuizSection()
        }
    }
}
```

- `@Composable`をつけた関数
- Composable関数はComposable関数の中でしか呼べない
- 見た目に関する記述をするときに明示的につけよう
</Aside>

<Aside type="note" title="Modifierとは？">
<Image src={slide044} alt="Modifierとは" />

Compose修飾子で、コンポーザブルの見た目を装飾したり、拡張したりする動作を追加したり、見た目をより綺麗に整える。

### できることの一例

| 機能 | 説明 |
|------|------|
| 背景色の変更 | 要素の背景色を設定 |
| ボーダーをつける | 要素に枠線を追加 |
| 余白をつける | padding で余白を設定 |
| 要素を画面いっぱいに広げる | fillMaxWidth, fillMaxHeight |

### fillMaxWidth / fillMaxHeight

<Image src={slide045} alt="fillMaxWidth / fillMaxHeight" />

要素を画面いっぱいに広げます。

```kotlin
Button(
    onClick = {},
    modifier = Modifier.fillMaxWidth(),
) {
    Text(text = "button")
}
```

### padding

<Image src={slide046} alt="padding" />

要素に空白をつけます。

```kotlin
Text(
    text = "padding",
    modifier = Modifier
        .border(1.dp, Color.Green)
        .padding(8.dp)
)
```

他にもたくさんのModifierがあります。詳しくは以下を参照。

<Image src={slide047} alt="Modifierの詳細" />

https://developer.android.com/develop/ui/compose/modifiers?hl=ja
</Aside>

## コンポーネントを配置しよう

<Image src={slide048} alt="コンポーネントを配置" />

`CountAppScreen`の中身を作ろう。Textコンポーネントと、Buttonコンポーネントを配置します。

```kotlin
@Composable
fun CountAppScreen(modifier: Modifier = Modifier) {
    Text(
        text = "カウント: 0",
        textAlign = TextAlign.Center
    )

    Button(
        onClick = {
            // ここに値を追加する処理を書く
        }
    ) {
        Text(
            "+",
        )
    }
}
```

<Aside>
TextとButtonについては、次のスライドで説明します。また、赤いエラーについても説明します。
</Aside>

<Aside type="note" title="importについて">
<Image src={import_gif} alt="importについて" />

赤くなっているTextにカーソルを重ねて Macの人は `option + return`、Winの人は `alt + enter` を押して、インポートするライブラリを選択する。

ライブラリは、今回の場合コンポーザブルに関するものなので、`Composable`と最初についているものを選ぼう。
</Aside>

<Aside type="note" title="Textについて">
<Image src={slide050} alt="Textについて" />

テキストを表示するための関数。Colorなどの引数をつけることで、色なども指定できる。

```kotlin
Text("バームクーヘン")
```

色を指定する場合：

```kotlin
Text(
    text = "バームクーヘン",
    color = Color.Red
)
```
</Aside>

<Aside type="note" title="TextAlignについて">
<Image src={slide051} alt="TextAlignについて" />

テキストをどちらに寄せるのかを記載する。

| 設定 | 説明 |
|------|------|
| `TextAlign.Start` | 左寄せ |
| `TextAlign.Center` | 中心寄せ |
| `TextAlign.End` | 右寄せ |

```kotlin
Text(
    text = "カウント: 0",
    textAlign = TextAlign.Center
)
```
</Aside>

<Aside type="note" title="Buttonについて">
<Image src={slide052} alt="Buttonについて" />

ボタンを作成できるコンポーネント。`onClick`を用意することで、動作を記述できる。また、Buttonの中にTextを用意することで、文字を表示することができる。

```kotlin
Button(onClick = { /*TODO*/ }) {
    Text(text = "ボタン")
}
```
</Aside>

## 実際に動かしてみる

<Image src={slide053} alt="実際に動かしてみる" />
<Image src={run_app} alt="実際に動かしてみる" width={400} />

Android Studioの上部にある「Run 'app'」ボタン（再生ボタン）をクリックします。

これで、エミュレータが立ち上がり、自動でコードがビルドされます。

## 変な位置に重なって表示される

<Image src={slide054} alt="変な位置に重なって表示される" />

実行してみると、テキストとボタンが重なって変な位置に表示されることがあります。

これには2つの原因があります：

1. **隙間が一切ない** - 原因：`innerPadding`が設定されてない
2. **テキストとボタンが重なってる** - 原因：コンポーネントが縦並びになっていない

次のセクションでこれらの問題を解決していきます。

## 修正を入れてみよう

<Image src={slide055} alt="修正を入れてみよう" />

`CountAppScreen`を`Column`で囲み、`modifier`を追加します。

```kotlin
@Composable
fun CountAppScreen(modifier: Modifier = Modifier) {
    Column(
        modifier = modifier
    ) {
        Text(
            text = "カウント: 0",
            textAlign = TextAlign.Center
        )

        Button(
            onClick = {
                // ここに値を追加する処理を書く
            }
        ) {
            Text(
                "+",
            )
        }
    }
}
```

<Aside type="note" title="Column Rowについて">
<Image src={slide056} alt="Column Rowについて" />

要素を縦に並べたり横に並べたりするコンポーネントです。

| コンポーネント | 説明 |
|------|------|
| `Column` | 要素を**縦**に並べる |
| `Row` | 要素を**横**に並べる |

<Image src={slide057} alt="Column Rowの組み合わせ" />

ColumnとRowを組み合わせて自由にレイアウトを作ることができます。

```kotlin
Column {
    Row {
        Text(text = "1")
        Text(text = "2")
    }
    Text(text = "3")
}
```
</Aside>

<Aside type="note" title="innerPaddingとは？">
<Image src={slide058} alt="innerPaddingとは" />

アプリを表示させるにあたり、様々な情報が表示されて、かぶってしまう領域が設定されているpaddingの値です。

この部分を覆い被さらないようにpaddingが設定されます。
</Aside>

## このように表示されましたか？

<Image src={slide059} alt="修正後の表示結果" />

修正が完了すると、カウントのテキストと+ボタンが縦に並んで、正しい位置に表示されるようになります。
