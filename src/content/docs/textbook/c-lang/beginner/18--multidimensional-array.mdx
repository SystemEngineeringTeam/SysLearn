---
title : 多次元配列
slug: http://localhost:4321/textbook/c-lang/beginner/multidimensional-array
---

import { Aside } from '@astrojs/starlight/components';
import { Tabs, TabItem } from '@astrojs/starlight/components';

`int`や`double`などの単一型の変数を集めたものを配列といいました。
実は、その配列を集めることで『配列の配列』をつくることができます。
実際に、『配列の配列』について学んでいきましょう。

## 多次元配列

配列の考え方を応用することで、配列の要素自体が《配列》である配列をつくることができます。

配列を要素型とする配列を**２次元配列**と呼び、この２次元配列を要素型とする配列を**３次元配列**と呼びます。
２次元以上の配列を総称したものが**多次元配列**（multidimensional array）となります。

## ２次元配列

例として、３つの要素をもつ２つの配列を考えてみましょう。
１次元配列の宣言は、次のようにして実現することができました。

```c
int a[3] = {1, 2, 3};
int b[3] = {4, 5, 6};
```

これら２つの配列を要素にもつ配列（二次元配列）を宣言する場合、次のようになります。

```c
int c[2][3] = {
    {1, 2, 3},
    {4, 5, 6}
};
```

<Aside type="note" title="２次元配列の宣言">
- 変数の宣言
`要素型 変数名;`
```c
int a;  // 単一のint型
```
- １次元配列の宣言
`要素型 配列名[要素数];`
```c
int a[3];  // 上記の変数を３個まとめて配列化
```
- ２次元配列の宣言
`要素型 配列名[配列の要素数（行数）][要素の要素数（列数）];`
```c
int a[3][4];  // 上記の配列を４個まとめて配列化
```
</Aside>

## ２次元配列とその走査

多次元配列の走査では、多重ループを用いて実現します。

`for`文による二重ループを用いた、二次元配列の走査を確認してみましょう。
次のプログラムは、二次元配列によって九九の表を再現したものになります。

<Tabs>
<TabItem label="ソースコード">
```c
#include <stdio.h>

#define ROWS 9  // 行数
#define COLS 9  // 列数

int main(int argc, const char * argv[]) {
    int table[9][9];
    
    // 二次元配列の初期化
    for (int i = 0; i < ROWS; i++) {
        for (int j = 0; j < COLS; j++) {
            table[i][j] = (i + 1) * (j + 1);
        }
    }
    
    // 九九表の出力
    for (int i = 0; i < ROWS; i++) {
        for (int j = 0; j < COLS; j++) {
            printf("%3d", table[i][j]);
        }
        putchar('\n');  // 改行
    }
    
    return 0;
}
```
</TabItem>
<TabItem label="実行例">
```
  1  2  3  4  5  6  7  8  9
  2  4  6  8 10 12 14 16 18
  3  6  9 12 15 18 21 24 27
  4  8 12 16 20 24 28 32 36
  5 10 15 20 25 30 35 40 45
  6 12 18 24 30 36 42 48 54
  7 14 21 28 35 42 49 56 63
  8 16 24 32 40 48 56 64 72
  9 18 27 36 45 54 63 72 81
```
</TabItem>
</Tabs>

プログラムの冒頭に、`#define`から始まる命令文が記述されています。
これは、**オブジェクト形式マクロ**（object-like macro）を定義するための特殊な宣言であり、**`#define`指令**（#define directive）と呼びます。

## オブジェクト形式マクロ

```c
#define A b  // この指令以降の A を b とせよ
```

この指令文以降に記述された`A`は、`b`に置換された上でプログラムが翻訳・実行されることになります。
また、**マクロ名**（macro name）`A`は、一般的な変数と区別するために、大文字で定義する慣習があります。

上記の九九表を出力するプログラムでは、行数`ROWS`および列数`COLS`に対して、`9`という数値が割り当てられています。
この値を変更することで、出力される九九表のサイズを変えることができます。

プログラム中に直接記述された数値を**マジックナンバー**と呼びます（何を表す数値なのかが不明なため）。
オブジェクト形式マクロを活用することで、値の管理を１文に集約させたり、マジックナンバーを減らしたりすることに役立ちます。

オブジェクト形式マクロを活用することで、プログラムの品質を向上させましょう。

<Aside type="note" title="オブジェクト形式マクロのメリット">
- 値の管理を１文に集約できる
- 定数に対して名前が与えられる
- マジックナンバーを除去できる
</Aside>

## 練習問題

<Tabs>
<TabItem label="問題">
次の表は、３人の学生のテストの点数をまとめたものになります。
この表の値を二次元配列`scores`で初期化し、再現してください。
また、ひとりひとりの５教科におけるテストの平均点を格納する配列`avg`を用いることで、平均点数を算出して、結果を出力してください。

| 学籍番号 | 国語 | 社会 | 算数 | 理科 | 英語 |
| -------- | ---- | ---- | ---- | ---- | ---- |
|   0001   |   58 |   46 |  100 |   89 |   64 |
|   0002   |   98 |   96 |   32 |   38 |   72 |
|   0003   |   34 |   62 |   28 |   88 |   25 |
</TabItem>
<TabItem label="実行例">
```
0001: 71.4
0002: 67.2
0003: 47.4
```
</TabItem>
<TabItem label="ヒント１">
表の値を用いることで、次のようにな二次元配列を作成しましょう。

```c
int scores[3][5] = {
    {58,  46, 100,  89,  64},  // 学籍番号 0001
    {98,  96,  32,  38,  72},  // 学籍番号 0002
    {34,  62,  28,  88,  25}   // 学籍番号 0003
};
```
</TabItem>
<TabItem label="ヒント２">
平均値は、次のような二次元配列の走査によって算出します。
配列`avg`の要素型が`double`型であることに注意しましょう。

```c
double avg[3] = {0};

// 平均値の算出
for (int i = 0; i < 3; i++) {
    for (int j = 0; j < 5; j++) {
        avg[***] += scores[***][***];  // 合計点数を算出
    }
    avg[***] /= 5;  // 平均点数を算出
}
```
</TabItem>
<TabItem label="解答例">
```c
#include <stdio.h>

int main(int argc, const char * argv[]) {
    int scores[3][5] = {
        {58,  46, 100,  89,  64},  // 学籍番号 0001
        {98,  96,  32,  38,  72},  // 学籍番号 0002
        {34,  62,  28,  88,  25}   // 学籍番号 0003
    };
    
    double avg[3] = {0};
    
    // 平均値の算出
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 5; j++) {
            avg[i] += scores[i][j];  // 合計点数を算出
        }
        avg[i] /= 5;  // 平均点数を算出
    }
    
    // 結果の出力
    for (int i = 0; i < 3; i++) {
        printf("%04d: %.1f\n", i + 1, avg[i]);
    }
    
    return 0;
}
```
</TabItem>
</Tabs>
